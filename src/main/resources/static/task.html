<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>æ ¡å›­å¸®å¸® - ä»»åŠ¡å¤§å…</title>
    <!-- å¼•å…¥ Vue å’Œ ElementUI æ ·å¼ï¼Œä¸ç”¨ä¸‹è½½ï¼Œç›´æ¥ç”¨ CDN -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/vue@2/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body style="background-color: #f5f5f5; padding: 20px;">
<div id="app">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <el-card>
        <div slot="header" style="display: flex; justify-content: space-between; align-items: center;">
            <span style="font-weight: bold; font-size: 20px;">ğŸš€ æ ¡å›­å¸®å¸® Task Hall</span>
            <el-button type="primary" @click="dialogVisible = true">å‘å¸ƒä»»åŠ¡ +</el-button>
        </div>
    </el-card>

    <!-- ä»»åŠ¡åˆ—è¡¨ -->
    <el-row :gutter="20" style="margin-top: 20px;">
        <el-col :span="8" v-for="task in taskList" :key="task.id" style="margin-bottom: 20px;">
            <el-card shadow="hover">
                <div slot="header">
                    <span style="font-weight: bold;">{{ task.title }}</span>
                    <el-tag type="danger" style="float: right;">ï¿¥{{ task.reward }}</el-tag>
                </div>
                <div style="font-size: 14px; color: #666;">
                    <p>ğŸ“ å–ä»¶ï¼š{{ task.locationFrom }}</p>
                    <p>ğŸ é€è¾¾ï¼š{{ task.locationTo }}</p>
                    <p>ğŸ•’ æˆªæ­¢ï¼š{{ task.deadline }}</p>
                    <p>ğŸ“ å¤‡æ³¨ï¼š{{ task.description }}</p>
                </div>
                <el-button type="success" size="small" style="width: 100%; margin-top: 10px;">ç«‹å³æŠ¢å•</el-button>
            </el-card>
        </el-col>
    </el-row>

    <!-- å‘å¸ƒä»»åŠ¡å¼¹çª— -->
    <el-dialog title="å‘å¸ƒæ–°ä»»åŠ¡" :visible.sync="dialogVisible" width="40%">
        <el-form :model="form" label-width="80px">
            <el-form-item label="æ ‡é¢˜">
                <el-input v-model="form.title" placeholder="ä¾‹å¦‚ï¼šå¸®å–å¿«é€’"></el-input>
            </el-form-item>
            <el-form-item label="èµé‡‘">
                <el-input v-model="form.reward" placeholder="ä¾‹å¦‚ï¼š5.00"></el-input>
            </el-form-item>
            <el-form-item label="å–ä»¶åœ°">
                <el-input v-model="form.locationFrom" placeholder="ä¾‹å¦‚ï¼šä¸œé—¨èœé¸Ÿé©¿ç«™"></el-input>
            </el-form-item>
            <el-form-item label="é€è¾¾åœ°">
                <el-input v-model="form.locationTo" placeholder="ä¾‹å¦‚ï¼šè¥¿ä¸‰å®¿èˆæ¥¼"></el-input>
            </el-form-item>
        </el-form>
        <span slot="footer" class="dialog-footer">
                <el-button @click="dialogVisible = false">å– æ¶ˆ</el-button>
                <el-button type="primary" @click="submitTask">ç¡® å®š</el-button>
            </span>
    </el-dialog>
</div>

<script>
    new Vue({
        el: '#app',
        data: {
            dialogVisible: false,
            taskList: [],
            form: {
                publisherId: 1, // æš‚æ—¶å†™æ­»ï¼Œå‡è£…æ˜¯ IDä¸º1 çš„ç”¨æˆ·å‘çš„
                title: '',
                reward: '',
                locationFrom: '',
                locationTo: ''
            }
        },
        created() {
            this.loadTasks();
        },
        methods: {
            // åŠ è½½ä»»åŠ¡åˆ—è¡¨
            loadTasks() {
                axios.get('/task/list').then(res => {
                    if (res.data.code === 200) {
                        this.taskList = res.data.data.records;
                    }
                });
            },
            // æäº¤ä»»åŠ¡
            submitTask() {
                axios.post('/task/publish', this.form).then(res => {
                    if (res.data.code === 200) {
                        this.$message.success('å‘å¸ƒæˆåŠŸï¼');
                        this.dialogVisible = false;
                        this.loadTasks(); // åˆ·æ–°åˆ—è¡¨
                    } else {
                        this.$message.error(res.data.msg);
                    }
                });
            }
        }
    })
</script>
</body>
</html>